from django.db import IntegrityError
from django.http import HttpResponseRedirect, HttpResponseServerError
from django.shortcuts import render
from django.shortcuts import HttpResponse
from django.views.decorators.csrf import csrf_exempt

from ec import models


# Create your views here.


def index(request):
    # request.POST
    # request.GET
    # return HttpResponse("Hello word")
    # if "/index/" == request.path:
    #     return find_all_tables(request)
    # if "/index/createTable" == request.path:
    #     return create_table(request)
    # return HttpResponse("something wrong")
    tables = models.ExcelTable.objects.all()
    return render(request, "index.html", {"tables": tables})


def edit_table(request):
    tid = request.POST.get("id")
    title = request.POST.get("title")
    presentation = request.POST.get("presentation")
    try:
        if "" == tid:
            table = models.ExcelTable.objects.create(name=title, presentation=presentation)
        else:
            table = models.ExcelTable.objects.get(id=tid)
            table.name = title
            table.presentation = presentation
        table.save()
        return HttpResponse("ok")
    except IntegrityError as msg:
        return HttpResponse(msg)


def delete_table(request, tabid):
    try:
        table = models.ExcelTable.objects.get(id=tabid)
        models.TableData.objects.filter(excelTable_id=tabid).delete()
        table.delete()
        return HttpResponse("ok")
    except Exception as msg:
        return HttpResponse(msg)


def view_table(request):
    tabid = request.GET.get("tabid")
    tds = models.TableData.objects.filter(excelTable_id=tabid).order_by("-lastUpdate")
    if tds.exists():
        td = tds.first()
        return render(request, "table.html", {"tabid": tabid, "tableData": td.data })
    else:
        data = """
            <tbody><tr id="tableHead"><th id="rowNumber">#</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th><th>Z</th></tr></tbody><tbody id="tableBody"><tr><td rowidex="0" columidex="@" rowindex="0" columnindex="@">0</td><td rowidex="0" columidex="A" rowindex="0" columnindex="A"></td><td rowidex="0" columidex="B" rowindex="0" columnindex="B"></td><td rowidex="0" columidex="C" rowindex="0" columnindex="C"></td><td rowidex="0" columidex="D" rowindex="0" columnindex="D"></td><td rowidex="0" columidex="E" rowindex="0" columnindex="E"></td><td rowidex="0" columidex="F" rowindex="0" columnindex="F"></td><td rowidex="0" columidex="G" rowindex="0" columnindex="G"></td><td rowidex="0" columidex="H" rowindex="0" columnindex="H"></td><td rowidex="0" columidex="I" rowindex="0" columnindex="I"></td><td rowidex="0" columidex="J" rowindex="0" columnindex="J"></td><td rowidex="0" columidex="K" rowindex="0" columnindex="K"></td><td rowidex="0" columidex="L" rowindex="0" columnindex="L"></td><td rowidex="0" columidex="M" rowindex="0" columnindex="M"></td><td rowidex="0" columidex="N" rowindex="0" columnindex="N"></td><td rowidex="0" columidex="O" rowindex="0" columnindex="O"></td><td rowindex="0" columnindex="P"></td><td rowidex="0" columidex="P" rowindex="0" columnindex="Q"></td><td rowidex="0" columidex="Q" rowindex="0" columnindex="R"></td><td rowidex="0" columidex="R" rowindex="0" columnindex="S"></td><td rowidex="0" columidex="S" rowindex="0" columnindex="T"></td><td rowidex="0" columidex="T" rowindex="0" columnindex="U"></td><td rowidex="0" columidex="U" rowindex="0" columnindex="V"></td><td rowidex="0" columidex="V" rowindex="0" columnindex="W"></td><td rowidex="0" columidex="W" rowindex="0" columnindex="X"></td><td rowidex="0" columidex="X" rowindex="0" columnindex="Y"></td><td rowidex="0" columidex="Y" rowindex="0" columnindex="Z"></td></tr><tr><td rowidex="1" columidex="@" rowindex="1" columnindex="@">1</td><td rowidex="1" columidex="A" rowindex="1" columnindex="A"></td><td rowidex="1" columidex="B" rowindex="1" columnindex="B"></td><td rowidex="1" columidex="C" rowindex="1" columnindex="C"></td><td rowidex="1" columidex="D" rowindex="1" columnindex="D"></td><td rowidex="1" columidex="E" rowindex="1" columnindex="E"></td><td rowidex="1" columidex="F" rowindex="1" columnindex="F"></td><td rowidex="1" columidex="G" rowindex="1" columnindex="G"></td><td rowidex="1" columidex="H" rowindex="1" columnindex="H"></td><td rowidex="1" columidex="I" rowindex="1" columnindex="I"></td><td rowidex="1" columidex="J" rowindex="1" columnindex="J"></td><td rowidex="1" columidex="K" rowindex="1" columnindex="K"></td><td rowidex="1" columidex="L" rowindex="1" columnindex="L"></td><td rowidex="1" columidex="M" rowindex="1" columnindex="M"></td><td rowidex="1" columidex="N" rowindex="1" columnindex="N"></td><td rowidex="1" columidex="O" rowindex="1" columnindex="O"></td><td rowindex="1" columnindex="P"></td><td rowidex="1" columidex="P" rowindex="1" columnindex="Q"></td><td rowidex="1" columidex="Q" rowindex="1" columnindex="R"></td><td rowidex="1" columidex="R" rowindex="1" columnindex="S"></td><td rowidex="1" columidex="S" rowindex="1" columnindex="T"></td><td rowidex="1" columidex="T" rowindex="1" columnindex="U"></td><td rowidex="1" columidex="U" rowindex="1" columnindex="V"></td><td rowidex="1" columidex="V" rowindex="1" columnindex="W"></td><td rowidex="1" columidex="W" rowindex="1" columnindex="X"></td><td rowidex="1" columidex="X" rowindex="1" columnindex="Y"></td><td rowidex="1" columidex="Y" rowindex="1" columnindex="Z"></td></tr><tr><td rowidex="2" columidex="@" rowindex="2" columnindex="@">2</td><td rowidex="2" columidex="A" rowindex="2" columnindex="A"></td><td rowidex="2" columidex="B" rowindex="2" columnindex="B"></td><td rowidex="2" columidex="C" rowindex="2" columnindex="C"></td><td rowidex="2" columidex="D" rowindex="2" columnindex="D"></td><td rowidex="2" columidex="E" rowindex="2" columnindex="E"></td><td rowidex="2" columidex="F" rowindex="2" columnindex="F"></td><td rowidex="2" columidex="G" rowindex="2" columnindex="G"></td><td rowidex="2" columidex="H" rowindex="2" columnindex="H"></td><td rowidex="2" columidex="I" rowindex="2" columnindex="I"></td><td rowidex="2" columidex="J" rowindex="2" columnindex="J"></td><td rowidex="2" columidex="K" rowindex="2" columnindex="K"></td><td rowidex="2" columidex="L" rowindex="2" columnindex="L"></td><td rowidex="2" columidex="M" rowindex="2" columnindex="M"></td><td rowidex="2" columidex="N" rowindex="2" columnindex="N"></td><td rowidex="2" columidex="O" rowindex="2" columnindex="O"></td><td rowindex="2" columnindex="P"></td><td rowidex="2" columidex="P" rowindex="2" columnindex="Q"></td><td rowidex="2" columidex="Q" rowindex="2" columnindex="R"></td><td rowidex="2" columidex="R" rowindex="2" columnindex="S"></td><td rowidex="2" columidex="S" rowindex="2" columnindex="T"></td><td rowidex="2" columidex="T" rowindex="2" columnindex="U"></td><td rowidex="2" columidex="U" rowindex="2" columnindex="V"></td><td rowidex="2" columidex="V" rowindex="2" columnindex="W"></td><td rowidex="2" columidex="W" rowindex="2" columnindex="X"></td><td rowidex="2" columidex="X" rowindex="2" columnindex="Y"></td><td rowidex="2" columidex="Y" rowindex="2" columnindex="Z"></td></tr><tr><td rowidex="3" columidex="@" rowindex="3" columnindex="@">3</td><td rowidex="3" columidex="A" rowindex="3" columnindex="A"></td><td rowidex="3" columidex="B" rowindex="3" columnindex="B"></td><td rowidex="3" columidex="C" rowindex="3" columnindex="C"></td><td rowidex="3" columidex="D" rowindex="3" columnindex="D"></td><td rowidex="3" columidex="E" rowindex="3" columnindex="E"></td><td rowidex="3" columidex="F" rowindex="3" columnindex="F"></td><td rowidex="3" columidex="G" rowindex="3" columnindex="G"></td><td rowidex="3" columidex="H" rowindex="3" columnindex="H"></td><td rowidex="3" columidex="I" rowindex="3" columnindex="I"></td><td rowidex="3" columidex="J" rowindex="3" columnindex="J"></td><td rowidex="3" columidex="K" rowindex="3" columnindex="K"></td><td rowidex="3" columidex="L" rowindex="3" columnindex="L"></td><td rowidex="3" columidex="M" rowindex="3" columnindex="M"></td><td rowidex="3" columidex="N" rowindex="3" columnindex="N"></td><td rowidex="3" columidex="O" rowindex="3" columnindex="O"></td><td rowindex="3" columnindex="P"></td><td rowidex="3" columidex="P" rowindex="3" columnindex="Q"></td><td rowidex="3" columidex="Q" rowindex="3" columnindex="R"></td><td rowidex="3" columidex="R" rowindex="3" columnindex="S"></td><td rowidex="3" columidex="S" rowindex="3" columnindex="T"></td><td rowidex="3" columidex="T" rowindex="3" columnindex="U"></td><td rowidex="3" columidex="U" rowindex="3" columnindex="V"></td><td rowidex="3" columidex="V" rowindex="3" columnindex="W"></td><td rowidex="3" columidex="W" rowindex="3" columnindex="X"></td><td rowidex="3" columidex="X" rowindex="3" columnindex="Y"></td><td rowidex="3" columidex="Y" rowindex="3" columnindex="Z"></td></tr><tr><td rowidex="4" columidex="@" rowindex="4" columnindex="@">4</td><td rowidex="4" columidex="A" rowindex="4" columnindex="A"></td><td rowidex="4" columidex="B" rowindex="4" columnindex="B"></td><td rowidex="4" columidex="C" rowindex="4" columnindex="C"></td><td rowidex="4" columidex="D" rowindex="4" columnindex="D"></td><td rowidex="4" columidex="E" rowindex="4" columnindex="E"></td><td rowidex="4" columidex="F" rowindex="4" columnindex="F"></td><td rowidex="4" columidex="G" rowindex="4" columnindex="G"></td><td rowidex="4" columidex="H" rowindex="4" columnindex="H"></td><td rowidex="4" columidex="I" rowindex="4" columnindex="I"></td><td rowidex="4" columidex="J" rowindex="4" columnindex="J"></td><td rowidex="4" columidex="K" rowindex="4" columnindex="K"></td><td rowidex="4" columidex="L" rowindex="4" columnindex="L"></td><td rowidex="4" columidex="M" rowindex="4" columnindex="M"></td><td rowidex="4" columidex="N" rowindex="4" columnindex="N"></td><td rowidex="4" columidex="O" rowindex="4" columnindex="O"></td><td rowindex="4" columnindex="P"></td><td rowidex="4" columidex="P" rowindex="4" columnindex="Q"></td><td rowidex="4" columidex="Q" rowindex="4" columnindex="R"></td><td rowidex="4" columidex="R" rowindex="4" columnindex="S"></td><td rowidex="4" columidex="S" rowindex="4" columnindex="T"></td><td rowidex="4" columidex="T" rowindex="4" columnindex="U"></td><td rowidex="4" columidex="U" rowindex="4" columnindex="V"></td><td rowidex="4" columidex="V" rowindex="4" columnindex="W"></td><td rowidex="4" columidex="W" rowindex="4" columnindex="X"></td><td rowidex="4" columidex="X" rowindex="4" columnindex="Y"></td><td rowidex="4" columidex="Y" rowindex="4" columnindex="Z"></td></tr><tr><td rowidex="5" columidex="@" rowindex="5" columnindex="@">5</td><td rowidex="5" columidex="A" rowindex="5" columnindex="A"></td><td rowidex="5" columidex="B" rowindex="5" columnindex="B"></td><td rowidex="5" columidex="C" rowindex="5" columnindex="C"></td><td rowidex="5" columidex="D" rowindex="5" columnindex="D"></td><td rowidex="5" columidex="E" rowindex="5" columnindex="E"></td><td rowidex="5" columidex="F" rowindex="5" columnindex="F"></td><td rowidex="5" columidex="G" rowindex="5" columnindex="G"></td><td rowidex="5" columidex="H" rowindex="5" columnindex="H"></td><td rowidex="5" columidex="I" rowindex="5" columnindex="I"></td><td rowidex="5" columidex="J" rowindex="5" columnindex="J"></td><td rowidex="5" columidex="K" rowindex="5" columnindex="K"></td><td rowidex="5" columidex="L" rowindex="5" columnindex="L"></td><td rowidex="5" columidex="M" rowindex="5" columnindex="M"></td><td rowidex="5" columidex="N" rowindex="5" columnindex="N"></td><td rowidex="5" columidex="O" rowindex="5" columnindex="O"></td><td rowindex="5" columnindex="P"></td><td rowidex="5" columidex="P" rowindex="5" columnindex="Q"></td><td rowidex="5" columidex="Q" rowindex="5" columnindex="R"></td><td rowidex="5" columidex="R" rowindex="5" columnindex="S"></td><td rowidex="5" columidex="S" rowindex="5" columnindex="T"></td><td rowidex="5" columidex="T" rowindex="5" columnindex="U"></td><td rowidex="5" columidex="U" rowindex="5" columnindex="V"></td><td rowidex="5" columidex="V" rowindex="5" columnindex="W"></td><td rowidex="5" columidex="W" rowindex="5" columnindex="X"></td><td rowidex="5" columidex="X" rowindex="5" columnindex="Y"></td><td rowidex="5" columidex="Y" rowindex="5" columnindex="Z"></td></tr><tr><td rowidex="6" columidex="@" rowindex="6" columnindex="@">6</td><td rowidex="6" columidex="A" rowindex="6" columnindex="A"></td><td rowidex="6" columidex="B" rowindex="6" columnindex="B"></td><td rowidex="6" columidex="C" rowindex="6" columnindex="C"></td><td rowidex="6" columidex="D" rowindex="6" columnindex="D"></td><td rowidex="6" columidex="E" rowindex="6" columnindex="E"></td><td rowidex="6" columidex="F" rowindex="6" columnindex="F"></td><td rowidex="6" columidex="G" rowindex="6" columnindex="G"></td><td rowidex="6" columidex="H" rowindex="6" columnindex="H"></td><td rowidex="6" columidex="I" rowindex="6" columnindex="I"></td><td rowidex="6" columidex="J" rowindex="6" columnindex="J"></td><td rowidex="6" columidex="K" rowindex="6" columnindex="K"></td><td rowidex="6" columidex="L" rowindex="6" columnindex="L"></td><td rowidex="6" columidex="M" rowindex="6" columnindex="M"></td><td rowidex="6" columidex="N" rowindex="6" columnindex="N"></td><td rowidex="6" columidex="O" rowindex="6" columnindex="O"></td><td rowindex="6" columnindex="P"></td><td rowidex="6" columidex="P" rowindex="6" columnindex="Q"></td><td rowidex="6" columidex="Q" rowindex="6" columnindex="R"></td><td rowidex="6" columidex="R" rowindex="6" columnindex="S"></td><td rowidex="6" columidex="S" rowindex="6" columnindex="T"></td><td rowidex="6" columidex="T" rowindex="6" columnindex="U"></td><td rowidex="6" columidex="U" rowindex="6" columnindex="V"></td><td rowidex="6" columidex="V" rowindex="6" columnindex="W"></td><td rowidex="6" columidex="W" rowindex="6" columnindex="X"></td><td rowidex="6" columidex="X" rowindex="6" columnindex="Y"></td><td rowidex="6" columidex="Y" rowindex="6" columnindex="Z"></td></tr><tr><td rowidex="7" columidex="@" rowindex="7" columnindex="@">7</td><td rowidex="7" columidex="A" rowindex="7" columnindex="A"></td><td rowidex="7" columidex="B" rowindex="7" columnindex="B"></td><td rowidex="7" columidex="C" rowindex="7" columnindex="C"></td><td rowidex="7" columidex="D" rowindex="7" columnindex="D"></td><td rowidex="7" columidex="E" rowindex="7" columnindex="E"></td><td rowidex="7" columidex="F" rowindex="7" columnindex="F"></td><td rowidex="7" columidex="G" rowindex="7" columnindex="G"></td><td rowidex="7" columidex="H" rowindex="7" columnindex="H"></td><td rowidex="7" columidex="I" rowindex="7" columnindex="I"></td><td rowidex="7" columidex="J" rowindex="7" columnindex="J"></td><td rowidex="7" columidex="K" rowindex="7" columnindex="K"></td><td rowidex="7" columidex="L" rowindex="7" columnindex="L"></td><td rowidex="7" columidex="M" rowindex="7" columnindex="M"></td><td rowidex="7" columidex="N" rowindex="7" columnindex="N"></td><td rowidex="7" columidex="O" rowindex="7" columnindex="O"></td><td rowindex="7" columnindex="P"></td><td rowidex="7" columidex="P" rowindex="7" columnindex="Q"></td><td rowidex="7" columidex="Q" rowindex="7" columnindex="R"></td><td rowidex="7" columidex="R" rowindex="7" columnindex="S"></td><td rowidex="7" columidex="S" rowindex="7" columnindex="T"></td><td rowidex="7" columidex="T" rowindex="7" columnindex="U"></td><td rowidex="7" columidex="U" rowindex="7" columnindex="V"></td><td rowidex="7" columidex="V" rowindex="7" columnindex="W"></td><td rowidex="7" columidex="W" rowindex="7" columnindex="X"></td><td rowidex="7" columidex="X" rowindex="7" columnindex="Y"></td><td rowidex="7" columidex="Y" rowindex="7" columnindex="Z"></td></tr><tr><td rowidex="8" columidex="@" rowindex="8" columnindex="@">8</td><td rowidex="8" columidex="A" rowindex="8" columnindex="A"></td><td rowidex="8" columidex="B" rowindex="8" columnindex="B"></td><td rowidex="8" columidex="C" rowindex="8" columnindex="C"></td><td rowidex="8" columidex="D" rowindex="8" columnindex="D"></td><td rowidex="8" columidex="E" rowindex="8" columnindex="E"></td><td rowidex="8" columidex="F" rowindex="8" columnindex="F"></td><td rowidex="8" columidex="G" rowindex="8" columnindex="G"></td><td rowidex="8" columidex="H" rowindex="8" columnindex="H"></td><td rowidex="8" columidex="I" rowindex="8" columnindex="I"></td><td rowidex="8" columidex="J" rowindex="8" columnindex="J"></td><td rowidex="8" columidex="K" rowindex="8" columnindex="K"></td><td rowidex="8" columidex="L" rowindex="8" columnindex="L"></td><td rowidex="8" columidex="M" rowindex="8" columnindex="M"></td><td rowidex="8" columidex="N" rowindex="8" columnindex="N"></td><td rowidex="8" columidex="O" rowindex="8" columnindex="O"></td><td rowindex="8" columnindex="P"></td><td rowidex="8" columidex="P" rowindex="8" columnindex="Q"></td><td rowidex="8" columidex="Q" rowindex="8" columnindex="R"></td><td rowidex="8" columidex="R" rowindex="8" columnindex="S"></td><td rowidex="8" columidex="S" rowindex="8" columnindex="T"></td><td rowidex="8" columidex="T" rowindex="8" columnindex="U"></td><td rowidex="8" columidex="U" rowindex="8" columnindex="V"></td><td rowidex="8" columidex="V" rowindex="8" columnindex="W"></td><td rowidex="8" columidex="W" rowindex="8" columnindex="X"></td><td rowidex="8" columidex="X" rowindex="8" columnindex="Y"></td><td rowidex="8" columidex="Y" rowindex="8" columnindex="Z"></td></tr><tr><td rowidex="9" columidex="@" rowindex="9" columnindex="@">9</td><td rowidex="9" columidex="A" rowindex="9" columnindex="A"></td><td rowidex="9" columidex="B" rowindex="9" columnindex="B"></td><td rowidex="9" columidex="C" rowindex="9" columnindex="C"></td><td rowidex="9" columidex="D" rowindex="9" columnindex="D"></td><td rowidex="9" columidex="E" rowindex="9" columnindex="E"></td><td rowidex="9" columidex="F" rowindex="9" columnindex="F"></td><td rowidex="9" columidex="G" rowindex="9" columnindex="G"></td><td rowidex="9" columidex="H" rowindex="9" columnindex="H"></td><td rowidex="9" columidex="I" rowindex="9" columnindex="I"></td><td rowidex="9" columidex="J" rowindex="9" columnindex="J"></td><td rowidex="9" columidex="K" rowindex="9" columnindex="K"></td><td rowidex="9" columidex="L" rowindex="9" columnindex="L"></td><td rowidex="9" columidex="M" rowindex="9" columnindex="M"></td><td rowidex="9" columidex="N" rowindex="9" columnindex="N"></td><td rowidex="9" columidex="O" rowindex="9" columnindex="O"></td><td rowindex="9" columnindex="P"></td><td rowidex="9" columidex="P" rowindex="9" columnindex="Q"></td><td rowidex="9" columidex="Q" rowindex="9" columnindex="R"></td><td rowidex="9" columidex="R" rowindex="9" columnindex="S"></td><td rowidex="9" columidex="S" rowindex="9" columnindex="T"></td><td rowidex="9" columidex="T" rowindex="9" columnindex="U"></td><td rowidex="9" columidex="U" rowindex="9" columnindex="V"></td><td rowidex="9" columidex="V" rowindex="9" columnindex="W"></td><td rowidex="9" columidex="W" rowindex="9" columnindex="X"></td><td rowidex="9" columidex="X" rowindex="9" columnindex="Y"></td><td rowidex="9" columidex="Y" rowindex="9" columnindex="Z"></td></tr><tr><td rowindex="10" columnindex="@">10</td><td rowindex="10" columnindex="A"></td><td rowindex="10" columnindex="B"></td><td rowindex="10" columnindex="C"></td><td rowindex="10" columnindex="D"></td><td rowindex="10" columnindex="E"></td><td rowindex="10" columnindex="F"></td><td rowindex="10" columnindex="G"></td><td rowindex="10" columnindex="H"></td><td rowindex="10" columnindex="I"></td><td rowindex="10" columnindex="J"></td><td rowindex="10" columnindex="K"></td><td rowindex="10" columnindex="L"></td><td rowindex="10" columnindex="M"></td><td rowindex="10" columnindex="N"></td><td rowindex="10" columnindex="O"></td><td rowindex="10" columnindex="P"></td><td rowindex="10" columnindex="Q"></td><td rowindex="10" columnindex="R"></td><td rowindex="10" columnindex="S"></td><td rowindex="10" columnindex="T"></td><td rowindex="10" columnindex="U"></td><td rowindex="10" columnindex="V"></td><td rowindex="10" columnindex="W"></td><td rowindex="10" columnindex="X"></td><td rowindex="10" columnindex="Y"></td><td rowindex="10" columnindex="Z"></td></tr><tr><td rowidex="10" columidex="@" rowindex="11" columnindex="@">11</td><td rowidex="10" columidex="A" rowindex="11" columnindex="A"></td><td rowidex="10" columidex="B" rowindex="11" columnindex="B"></td><td rowidex="10" columidex="C" rowindex="11" columnindex="C"></td><td rowidex="10" columidex="D" rowindex="11" columnindex="D"></td><td rowidex="10" columidex="E" rowindex="11" columnindex="E"></td><td rowidex="10" columidex="F" rowindex="11" columnindex="F"></td><td rowidex="10" columidex="G" rowindex="11" columnindex="G"></td><td rowidex="10" columidex="H" rowindex="11" columnindex="H"></td><td rowidex="10" columidex="I" rowindex="11" columnindex="I"></td><td rowidex="10" columidex="J" rowindex="11" columnindex="J"></td><td rowidex="10" columidex="K" rowindex="11" columnindex="K"></td><td rowidex="10" columidex="L" rowindex="11" columnindex="L"></td><td rowidex="10" columidex="M" rowindex="11" columnindex="M"></td><td rowidex="10" columidex="N" rowindex="11" columnindex="N"></td><td rowidex="10" columidex="O" rowindex="11" columnindex="O"></td><td rowindex="11" columnindex="P"></td><td rowidex="10" columidex="P" rowindex="11" columnindex="Q"></td><td rowidex="10" columidex="Q" rowindex="11" columnindex="R"></td><td rowidex="10" columidex="R" rowindex="11" columnindex="S"></td><td rowidex="10" columidex="S" rowindex="11" columnindex="T"></td><td rowidex="10" columidex="T" rowindex="11" columnindex="U"></td><td rowidex="10" columidex="U" rowindex="11" columnindex="V"></td><td rowidex="10" columidex="V" rowindex="11" columnindex="W"></td><td rowidex="10" columidex="W" rowindex="11" columnindex="X"></td><td rowidex="10" columidex="X" rowindex="11" columnindex="Y"></td><td rowidex="10" columidex="Y" rowindex="11" columnindex="Z"></td></tr><tr><td rowidex="11" columidex="@" rowindex="12" columnindex="@">12</td><td rowidex="11" columidex="A" rowindex="12" columnindex="A"></td><td rowidex="11" columidex="B" rowindex="12" columnindex="B"></td><td rowidex="11" columidex="C" rowindex="12" columnindex="C"></td><td rowidex="11" columidex="D" rowindex="12" columnindex="D"></td><td rowidex="11" columidex="E" rowindex="12" columnindex="E"></td><td rowidex="11" columidex="F" rowindex="12" columnindex="F"></td><td rowidex="11" columidex="G" rowindex="12" columnindex="G"></td><td rowidex="11" columidex="H" rowindex="12" columnindex="H"></td><td rowidex="11" columidex="I" rowindex="12" columnindex="I"></td><td rowidex="11" columidex="J" rowindex="12" columnindex="J"></td><td rowidex="11" columidex="K" rowindex="12" columnindex="K"></td><td rowidex="11" columidex="L" rowindex="12" columnindex="L"></td><td rowidex="11" columidex="M" rowindex="12" columnindex="M"></td><td rowidex="11" columidex="N" rowindex="12" columnindex="N"></td><td rowidex="11" columidex="O" rowindex="12" columnindex="O"></td><td rowindex="12" columnindex="P"></td><td rowidex="11" columidex="P" rowindex="12" columnindex="Q"></td><td rowidex="11" columidex="Q" rowindex="12" columnindex="R"></td><td rowidex="11" columidex="R" rowindex="12" columnindex="S"></td><td rowidex="11" columidex="S" rowindex="12" columnindex="T"></td><td rowidex="11" columidex="T" rowindex="12" columnindex="U"></td><td rowidex="11" columidex="U" rowindex="12" columnindex="V"></td><td rowidex="11" columidex="V" rowindex="12" columnindex="W"></td><td rowidex="11" columidex="W" rowindex="12" columnindex="X"></td><td rowidex="11" columidex="X" rowindex="12" columnindex="Y"></td><td rowidex="11" columidex="Y" rowindex="12" columnindex="Z"></td></tr><tr><td rowindex="13" columnindex="@">13</td><td rowindex="13" columnindex="A"></td><td rowindex="13" columnindex="B"></td><td rowindex="13" columnindex="C"></td><td rowindex="13" columnindex="D"></td><td rowindex="13" columnindex="E"></td><td rowindex="13" columnindex="F"></td><td rowindex="13" columnindex="G"></td><td rowindex="13" columnindex="H"></td><td rowindex="13" columnindex="I"></td><td rowindex="13" columnindex="J"></td><td rowindex="13" columnindex="K"></td><td rowindex="13" columnindex="L"></td><td rowindex="13" columnindex="M"></td><td rowindex="13" columnindex="N"></td><td rowindex="13" columnindex="O"></td><td rowindex="13" columnindex="P"></td><td rowindex="13" columnindex="Q"></td><td rowindex="13" columnindex="R"></td><td rowindex="13" columnindex="S"></td><td rowindex="13" columnindex="T"></td><td rowindex="13" columnindex="U"></td><td rowindex="13" columnindex="V"></td><td rowindex="13" columnindex="W"></td><td rowindex="13" columnindex="X"></td><td rowindex="13" columnindex="Y"></td><td rowindex="13" columnindex="Z"></td></tr><tr><td rowindex="14" columnindex="@">14</td><td rowindex="14" columnindex="A"></td><td rowindex="14" columnindex="B"></td><td rowindex="14" columnindex="C"></td><td rowindex="14" columnindex="D"></td><td rowindex="14" columnindex="E"></td><td rowindex="14" columnindex="F"></td><td rowindex="14" columnindex="G"></td><td rowindex="14" columnindex="H"></td><td rowindex="14" columnindex="I"></td><td rowindex="14" columnindex="J"></td><td rowindex="14" columnindex="K"></td><td rowindex="14" columnindex="L"></td><td rowindex="14" columnindex="M"></td><td rowindex="14" columnindex="N"></td><td rowindex="14" columnindex="O"></td><td rowindex="14" columnindex="P"></td><td rowindex="14" columnindex="Q"></td><td rowindex="14" columnindex="R"></td><td rowindex="14" columnindex="S"></td><td rowindex="14" columnindex="T"></td><td rowindex="14" columnindex="U"></td><td rowindex="14" columnindex="V"></td><td rowindex="14" columnindex="W"></td><td rowindex="14" columnindex="X"></td><td rowindex="14" columnindex="Y"></td><td rowindex="14" columnindex="Z"></td></tr><tr><td rowidex="13" columidex="@" rowindex="15" columnindex="@">15</td><td rowidex="13" columidex="A" rowindex="15" columnindex="A"></td><td rowidex="13" columidex="B" rowindex="15" columnindex="B"></td><td rowidex="13" columidex="C" rowindex="15" columnindex="C"></td><td rowidex="13" columidex="D" rowindex="15" columnindex="D"></td><td rowidex="13" columidex="E" rowindex="15" columnindex="E"></td><td rowidex="13" columidex="F" rowindex="15" columnindex="F"></td><td rowidex="13" columidex="G" rowindex="15" columnindex="G"></td><td rowidex="13" columidex="H" rowindex="15" columnindex="H"></td><td rowidex="13" columidex="I" rowindex="15" columnindex="I"></td><td rowidex="13" columidex="J" rowindex="15" columnindex="J"></td><td rowidex="13" columidex="K" rowindex="15" columnindex="K"></td><td rowidex="13" columidex="L" rowindex="15" columnindex="L"></td><td rowidex="13" columidex="M" rowindex="15" columnindex="M"></td><td rowidex="13" columidex="N" rowindex="15" columnindex="N"></td><td rowidex="13" columidex="O" rowindex="15" columnindex="O"></td><td rowindex="15" columnindex="P"></td><td rowidex="13" columidex="P" rowindex="15" columnindex="Q"></td><td rowidex="13" columidex="Q" rowindex="15" columnindex="R"></td><td rowidex="13" columidex="R" rowindex="15" columnindex="S"></td><td rowidex="13" columidex="S" rowindex="15" columnindex="T"></td><td rowidex="13" columidex="T" rowindex="15" columnindex="U"></td><td rowidex="13" columidex="U" rowindex="15" columnindex="V"></td><td rowidex="13" columidex="V" rowindex="15" columnindex="W"></td><td rowidex="13" columidex="W" rowindex="15" columnindex="X"></td><td rowidex="13" columidex="X" rowindex="15" columnindex="Y"></td><td rowidex="13" columidex="Y" rowindex="15" columnindex="Z"></td></tr><tr><td rowindex="16" columnindex="@">16</td><td rowindex="16" columnindex="A"></td><td rowindex="16" columnindex="B"></td><td rowindex="16" columnindex="C"></td><td rowindex="16" columnindex="D"></td><td rowindex="16" columnindex="E"></td><td rowindex="16" columnindex="F"></td><td rowindex="16" columnindex="G"></td><td rowindex="16" columnindex="H"></td><td rowindex="16" columnindex="I"></td><td rowindex="16" columnindex="J"></td><td rowindex="16" columnindex="K"></td><td rowindex="16" columnindex="L"></td><td rowindex="16" columnindex="M"></td><td rowindex="16" columnindex="N"></td><td rowindex="16" columnindex="O"></td><td rowindex="16" columnindex="P"></td><td rowindex="16" columnindex="Q"></td><td rowindex="16" columnindex="R"></td><td rowindex="16" columnindex="S"></td><td rowindex="16" columnindex="T"></td><td rowindex="16" columnindex="U"></td><td rowindex="16" columnindex="V"></td><td rowindex="16" columnindex="W"></td><td rowindex="16" columnindex="X"></td><td rowindex="16" columnindex="Y"></td><td rowindex="16" columnindex="Z"></td></tr><tr><td rowidex="14" columidex="@" rowindex="17" columnindex="@">17</td><td rowidex="14" columidex="A" rowindex="17" columnindex="A"></td><td rowidex="14" columidex="B" rowindex="17" columnindex="B"></td><td rowidex="14" columidex="C" rowindex="17" columnindex="C"></td><td rowidex="14" columidex="D" rowindex="17" columnindex="D"></td><td rowidex="14" columidex="E" rowindex="17" columnindex="E"></td><td rowidex="14" columidex="F" rowindex="17" columnindex="F"></td><td rowidex="14" columidex="G" rowindex="17" columnindex="G"></td><td rowidex="14" columidex="H" rowindex="17" columnindex="H"></td><td rowidex="14" columidex="I" rowindex="17" columnindex="I"></td><td rowidex="14" columidex="J" rowindex="17" columnindex="J"></td><td rowidex="14" columidex="K" rowindex="17" columnindex="K"></td><td rowidex="14" columidex="L" rowindex="17" columnindex="L"></td><td rowidex="14" columidex="M" rowindex="17" columnindex="M"></td><td rowidex="14" columidex="N" rowindex="17" columnindex="N"></td><td rowidex="14" columidex="O" rowindex="17" columnindex="O"></td><td rowindex="17" columnindex="P"></td><td rowidex="14" columidex="P" rowindex="17" columnindex="Q"></td><td rowidex="14" columidex="Q" rowindex="17" columnindex="R"></td><td rowidex="14" columidex="R" rowindex="17" columnindex="S"></td><td rowidex="14" columidex="S" rowindex="17" columnindex="T"></td><td rowidex="14" columidex="T" rowindex="17" columnindex="U"></td><td rowidex="14" columidex="U" rowindex="17" columnindex="V"></td><td rowidex="14" columidex="V" rowindex="17" columnindex="W"></td><td rowidex="14" columidex="W" rowindex="17" columnindex="X"></td><td rowidex="14" columidex="X" rowindex="17" columnindex="Y"></td><td rowidex="14" columidex="Y" rowindex="17" columnindex="Z"></td></tr><tr><td rowidex="15" columidex="@" rowindex="18" columnindex="@">18</td><td rowidex="15" columidex="A" rowindex="18" columnindex="A"></td><td rowidex="15" columidex="B" rowindex="18" columnindex="B"></td><td rowidex="15" columidex="C" rowindex="18" columnindex="C"></td><td rowidex="15" columidex="D" rowindex="18" columnindex="D"></td><td rowidex="15" columidex="E" rowindex="18" columnindex="E"></td><td rowidex="15" columidex="F" rowindex="18" columnindex="F"></td><td rowidex="15" columidex="G" rowindex="18" columnindex="G"></td><td rowidex="15" columidex="H" rowindex="18" columnindex="H"></td><td rowidex="15" columidex="I" rowindex="18" columnindex="I"></td><td rowidex="15" columidex="J" rowindex="18" columnindex="J"></td><td rowidex="15" columidex="K" rowindex="18" columnindex="K"></td><td rowidex="15" columidex="L" rowindex="18" columnindex="L"></td><td rowidex="15" columidex="M" rowindex="18" columnindex="M"></td><td rowidex="15" columidex="N" rowindex="18" columnindex="N"></td><td rowidex="15" columidex="O" rowindex="18" columnindex="O"></td><td rowindex="18" columnindex="P"></td><td rowidex="15" columidex="P" rowindex="18" columnindex="Q"></td><td rowidex="15" columidex="Q" rowindex="18" columnindex="R"></td><td rowidex="15" columidex="R" rowindex="18" columnindex="S"></td><td rowidex="15" columidex="S" rowindex="18" columnindex="T"></td><td rowidex="15" columidex="T" rowindex="18" columnindex="U"></td><td rowidex="15" columidex="U" rowindex="18" columnindex="V"></td><td rowidex="15" columidex="V" rowindex="18" columnindex="W"></td><td rowidex="15" columidex="W" rowindex="18" columnindex="X"></td><td rowidex="15" columidex="X" rowindex="18" columnindex="Y"></td><td rowidex="15" columidex="Y" rowindex="18" columnindex="Z"></td></tr><tr><td rowidex="16" columidex="@" rowindex="19" columnindex="@">19</td><td rowidex="16" columidex="A" rowindex="19" columnindex="A"></td><td rowidex="16" columidex="B" rowindex="19" columnindex="B"></td><td rowidex="16" columidex="C" rowindex="19" columnindex="C"></td><td rowidex="16" columidex="D" rowindex="19" columnindex="D"></td><td rowidex="16" columidex="E" rowindex="19" columnindex="E"></td><td rowidex="16" columidex="F" rowindex="19" columnindex="F"></td><td rowidex="16" columidex="G" rowindex="19" columnindex="G"></td><td rowidex="16" columidex="H" rowindex="19" columnindex="H"></td><td rowidex="16" columidex="I" rowindex="19" columnindex="I"></td><td rowidex="16" columidex="J" rowindex="19" columnindex="J"></td><td rowidex="16" columidex="K" rowindex="19" columnindex="K"></td><td rowidex="16" columidex="L" rowindex="19" columnindex="L"></td><td rowidex="16" columidex="M" rowindex="19" columnindex="M"></td><td rowidex="16" columidex="N" rowindex="19" columnindex="N"></td><td rowidex="16" columidex="O" rowindex="19" columnindex="O"></td><td rowindex="19" columnindex="P"></td><td rowidex="16" columidex="P" rowindex="19" columnindex="Q"></td><td rowidex="16" columidex="Q" rowindex="19" columnindex="R"></td><td rowidex="16" columidex="R" rowindex="19" columnindex="S"></td><td rowidex="16" columidex="S" rowindex="19" columnindex="T"></td><td rowidex="16" columidex="T" rowindex="19" columnindex="U"></td><td rowidex="16" columidex="U" rowindex="19" columnindex="V"></td><td rowidex="16" columidex="V" rowindex="19" columnindex="W"></td><td rowidex="16" columidex="W" rowindex="19" columnindex="X"></td><td rowidex="16" columidex="X" rowindex="19" columnindex="Y"></td><td rowidex="16" columidex="Y" rowindex="19" columnindex="Z"></td></tr><tr><td rowidex="17" columidex="@" rowindex="20" columnindex="@">20</td><td rowidex="17" columidex="A" rowindex="20" columnindex="A"></td><td rowidex="17" columidex="B" rowindex="20" columnindex="B"></td><td rowidex="17" columidex="C" rowindex="20" columnindex="C"></td><td rowidex="17" columidex="D" rowindex="20" columnindex="D"></td><td rowidex="17" columidex="E" rowindex="20" columnindex="E"></td><td rowidex="17" columidex="F" rowindex="20" columnindex="F"></td><td rowidex="17" columidex="G" rowindex="20" columnindex="G"></td><td rowidex="17" columidex="H" rowindex="20" columnindex="H"></td><td rowidex="17" columidex="I" rowindex="20" columnindex="I"></td><td rowidex="17" columidex="J" rowindex="20" columnindex="J"></td><td rowidex="17" columidex="K" rowindex="20" columnindex="K"></td><td rowidex="17" columidex="L" rowindex="20" columnindex="L"></td><td rowidex="17" columidex="M" rowindex="20" columnindex="M"></td><td rowidex="17" columidex="N" rowindex="20" columnindex="N"></td><td rowidex="17" columidex="O" rowindex="20" columnindex="O"></td><td rowindex="20" columnindex="P"></td><td rowidex="17" columidex="P" rowindex="20" columnindex="Q"></td><td rowidex="17" columidex="Q" rowindex="20" columnindex="R"></td><td rowidex="17" columidex="R" rowindex="20" columnindex="S"></td><td rowidex="17" columidex="S" rowindex="20" columnindex="T"></td><td rowidex="17" columidex="T" rowindex="20" columnindex="U"></td><td rowidex="17" columidex="U" rowindex="20" columnindex="V"></td><td rowidex="17" columidex="V" rowindex="20" columnindex="W"></td><td rowidex="17" columidex="W" rowindex="20" columnindex="X"></td><td rowidex="17" columidex="X" rowindex="20" columnindex="Y"></td><td rowidex="17" columidex="Y" rowindex="20" columnindex="Z"></td></tr><tr><td rowidex="18" columidex="@" rowindex="21" columnindex="@">21</td><td rowidex="18" columidex="A" rowindex="21" columnindex="A"></td><td rowidex="18" columidex="B" rowindex="21" columnindex="B"></td><td rowidex="18" columidex="C" rowindex="21" columnindex="C"></td><td rowidex="18" columidex="D" rowindex="21" columnindex="D"></td><td rowidex="18" columidex="E" rowindex="21" columnindex="E"></td><td rowidex="18" columidex="F" rowindex="21" columnindex="F"></td><td rowidex="18" columidex="G" rowindex="21" columnindex="G"></td><td rowidex="18" columidex="H" rowindex="21" columnindex="H"></td><td rowidex="18" columidex="I" rowindex="21" columnindex="I"></td><td rowidex="18" columidex="J" rowindex="21" columnindex="J"></td><td rowidex="18" columidex="K" rowindex="21" columnindex="K"></td><td rowidex="18" columidex="L" rowindex="21" columnindex="L"></td><td rowidex="18" columidex="M" rowindex="21" columnindex="M"></td><td rowidex="18" columidex="N" rowindex="21" columnindex="N"></td><td rowidex="18" columidex="O" rowindex="21" columnindex="O"></td><td rowindex="21" columnindex="P"></td><td rowidex="18" columidex="P" rowindex="21" columnindex="Q"></td><td rowidex="18" columidex="Q" rowindex="21" columnindex="R"></td><td rowidex="18" columidex="R" rowindex="21" columnindex="S"></td><td rowidex="18" columidex="S" rowindex="21" columnindex="T"></td><td rowidex="18" columidex="T" rowindex="21" columnindex="U"></td><td rowidex="18" columidex="U" rowindex="21" columnindex="V"></td><td rowidex="18" columidex="V" rowindex="21" columnindex="W"></td><td rowidex="18" columidex="W" rowindex="21" columnindex="X"></td><td rowidex="18" columidex="X" rowindex="21" columnindex="Y"></td><td rowidex="18" columidex="Y" rowindex="21" columnindex="Z"></td></tr><tr><td rowidex="19" columidex="@" rowindex="22" columnindex="@">22</td><td rowidex="19" columidex="A" rowindex="22" columnindex="A"></td><td rowidex="19" columidex="B" rowindex="22" columnindex="B"></td><td rowidex="19" columidex="C" rowindex="22" columnindex="C"></td><td rowidex="19" columidex="D" rowindex="22" columnindex="D"></td><td rowidex="19" columidex="E" rowindex="22" columnindex="E"></td><td rowidex="19" columidex="F" rowindex="22" columnindex="F"></td><td rowidex="19" columidex="G" rowindex="22" columnindex="G"></td><td rowidex="19" columidex="H" rowindex="22" columnindex="H"></td><td rowidex="19" columidex="I" rowindex="22" columnindex="I"></td><td rowidex="19" columidex="J" rowindex="22" columnindex="J"></td><td rowidex="19" columidex="K" rowindex="22" columnindex="K"></td><td rowidex="19" columidex="L" rowindex="22" columnindex="L"></td><td rowidex="19" columidex="M" rowindex="22" columnindex="M"></td><td rowidex="19" columidex="N" rowindex="22" columnindex="N"></td><td rowidex="19" columidex="O" rowindex="22" columnindex="O"></td><td rowindex="22" columnindex="P"></td><td rowidex="19" columidex="P" rowindex="22" columnindex="Q"></td><td rowidex="19" columidex="Q" rowindex="22" columnindex="R"></td><td rowidex="19" columidex="R" rowindex="22" columnindex="S"></td><td rowidex="19" columidex="S" rowindex="22" columnindex="T"></td><td rowidex="19" columidex="T" rowindex="22" columnindex="U"></td><td rowidex="19" columidex="U" rowindex="22" columnindex="V"></td><td rowidex="19" columidex="V" rowindex="22" columnindex="W"></td><td rowidex="19" columidex="W" rowindex="22" columnindex="X"></td><td rowidex="19" columidex="X" rowindex="22" columnindex="Y"></td><td rowidex="19" columidex="Y" rowindex="22" columnindex="Z"></td></tr><tr><td rowidex="20" columidex="@" rowindex="23" columnindex="@">23</td><td rowidex="20" columidex="A" rowindex="23" columnindex="A"></td><td rowidex="20" columidex="B" rowindex="23" columnindex="B"></td><td rowidex="20" columidex="C" rowindex="23" columnindex="C"></td><td rowidex="20" columidex="D" rowindex="23" columnindex="D"></td><td rowidex="20" columidex="E" rowindex="23" columnindex="E"></td><td rowidex="20" columidex="F" rowindex="23" columnindex="F"></td><td rowidex="20" columidex="G" rowindex="23" columnindex="G"></td><td rowidex="20" columidex="H" rowindex="23" columnindex="H"></td><td rowidex="20" columidex="I" rowindex="23" columnindex="I"></td><td rowidex="20" columidex="J" rowindex="23" columnindex="J"></td><td rowidex="20" columidex="K" rowindex="23" columnindex="K"></td><td rowidex="20" columidex="L" rowindex="23" columnindex="L"></td><td rowidex="20" columidex="M" rowindex="23" columnindex="M"></td><td rowidex="20" columidex="N" rowindex="23" columnindex="N"></td><td rowidex="20" columidex="O" rowindex="23" columnindex="O"></td><td rowindex="23" columnindex="P"></td><td rowidex="20" columidex="P" rowindex="23" columnindex="Q"></td><td rowidex="20" columidex="Q" rowindex="23" columnindex="R"></td><td rowidex="20" columidex="R" rowindex="23" columnindex="S"></td><td rowidex="20" columidex="S" rowindex="23" columnindex="T"></td><td rowidex="20" columidex="T" rowindex="23" columnindex="U"></td><td rowidex="20" columidex="U" rowindex="23" columnindex="V"></td><td rowidex="20" columidex="V" rowindex="23" columnindex="W"></td><td rowidex="20" columidex="W" rowindex="23" columnindex="X"></td><td rowidex="20" columidex="X" rowindex="23" columnindex="Y"></td><td rowidex="20" columidex="Y" rowindex="23" columnindex="Z"></td></tr></tbody>                                                                                                                                                                                                            
        """
        return render(request, "table.html", {"tabid": tabid, "tableData": data})


@csrf_exempt
def update_table_data(request):
    try:
        tabid = request.POST.get("tabid")
        tableData = request.POST.get("tableData")
        tds = models.TableData.objects.filter(excelTable_id=tabid).order_by("-lastUpdate")
        if tds.exists():
            td = tds.first()
        else:
            td = tds.create(excelTable_id=tabid)
        td.data = tableData
        td.save()
        return HttpResponse("ok")
    except Exception as msg:
        return HttpResponse(msg)
